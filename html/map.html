<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Find a Farm</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
    <link rel="stylesheet" href="/styles.css">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjYCKQ10b4HQRt28IodYoD3ORlGaz7Rhs&loading=async&callback=console.debug&libraries=maps,marker&v=beta">
    </script>
  </head>
  <body class="has-background-primary">
    <div id="nav-placeholder"></div>
    <div class="columns">
      <div class="column is-two-fifths">
        <div class="control m-2">
          <div class="columns">
            <div class="column pr-0">
              <div class="dropdown is-fullwidth">
                <div class="dropdown-trigger">
                  <button class="button" aria-haspopup="true" aria-controls="dropdown-menu3">
                    <span>Choose a Directory</span>
                    <span class="icon is-small">
                      <i class="fas fa-angle-down" aria-hidden="true"></i>
                    </span>
                  </button>
                </div>
                <div class="dropdown-menu" id="dropdown-menu3" role="menu">
                  <div class="dropdown-content">
                    <a href="#" class="dropdown-item">CSA</a>
                    <a href="#" class="dropdown-item">Food Hub</a>
                    <a href="#" class="dropdown-item">Farmers Market</a>
                    <a href="#" class="dropdown-item">On-Farm Market</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="column pr-0">
              <input class="input" id="zipcode" type="number" max="99999" placeholder="Enter Zip Code" />
            </div>
            <div class="column pr-0">
              <button id="submit" class="button is-link is-fullwidth">Search</button>  
              <script type="module" src="/src/search.js"></script>
            </div>
          </div>
        </div>
      </div>
      <div class="column mr-2">
        <gmp-map style="height: 95vh;" center="39.63592529296875,-86.8604507446289" zoom="14" map-id="DEMO_MAP_ID">
          <gmp-advanced-marker position="39.63592529296875,-86.8604507446289" title="My location"></gmp-advanced-marker>
        </gmp-map>
      </div>
    </div>
    <script>
      $(function(){
        $("#nav-placeholder").load("nav.html");
      });

      var dropdown = document.querySelector('.dropdown');
      dropdown.addEventListener('click', function(event) {
        event.stopPropagation();
        dropdown.classList.toggle('is-active');
      });

      function renderCard(listings) {
        listings.forEach(listing => {
          const card = document.createElement('div')
          card.classList = 'card'
          const cardimage = document.createElement('div')
          cardimage.classList = 'card-image'
          const imgclass = document.createElement('figure')
          imgclass.classList = 'image is-4by3'
          const img = document.createElement('img')
          img.classList = 'card-image'
          img.src = '/images/card-farmers-market'
          imgclass.appendChild(img)
          cardimage.appendChild(imgclass)
          card.appendChild(cardimage)

          const cardcontent = document.createElement('div')
          cardcontent.classList('card-content')
          const title = document.createElement('p')
          title.classList('title is-4')
          title.innerText = `${listing.listing_name}`
          cardcontent.appendChild(title)

          const content = document.createElement('div')
          content.innerText = `${listing.location_desc}<br>${listing.location_site}<br>${listing.location_indoor}<br>
          <span class = "has-text-success">${listing.specialproductionmethods}</span><br>${listing.SNAP_option}`
          cardcontent.appendChild(content)
        });
      }
    </script>
  </body>